
<div class="loader" *ngIf="loading"></div>
<div class="">
  <!-- main dashboard -->

  <!-- SEARCH -->
  <div class="row">
    <!-- search by id -->
    <div class="col-lg-4">
      <div class="row">
        <div class="terminal-id">
          <p>Terminal ID</p>
          <input
            class="form-control my-0 py-0 input-terminal"
            [ngModelOptions]="{ standalone: true }"
            ngDefaultControl
            type="text"
            placeholder=""
          />
        </div>
        <div class="terminal-model">
          <p>Model</p>
          <select
            ngDefaultControl
            [ngModelOptions]="{ standalone: true }"
            class="browser-default custom-select d-block select-model"
            mdbTooltip="How many times in a 24hr period"
            placement="top"
          >
            <option value="2">All model</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="6">6</option>
          </select>
        </div>
      </div>
    </div>

    <div class="col-lg-4"></div>

    <!-- filter -->
    <div class="col-lg-4">
      <div class="row">
        <div class="col model-type">
          <p>Model</p>
          <input
            class="form-control my-0 py-0 input-model"
            [ngModelOptions]="{ standalone: true }"
            ngDefaultControl
            type="text"
            placeholder=""
          />
        </div>
        <div class="model-name col">
          <p>Model Name</p>
          <input
            class="form-control my-0 py-0 input-name"
            [ngModelOptions]="{ standalone: true }"
            ngDefaultControl
            type="text"
            placeholder=""
          />
        </div>
        <div class="terminal-status col">
          <p>Status</p>
          <select
            ngDefaultControl
            [ngModelOptions]="{ standalone: true }"
            class="browser-default custom-select d-block select-status"
            mdbTooltip="How many times in a 24hr period"
            placement="top"
          >
            <option value="2">All</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="6">6</option>
          </select>
        </div>
        <button class="btn btn-sm btn-filter col">Filter</button>
      </div>
    </div>
  </div>

  <br />

  <!-- flexicons  -->
  <table class="flexicon">
    <tr class="flex-cont row">
      <td class="icons"  (click)="getTerminal(viewModal,false)">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/web.svg"
         
        /><a>View</a>
      </td>
      <td class="icons"   (click)="addModal.show();">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/ui.svg"
        
        /><a>Add</a>
      </td>
      <td class="icons"  (click)="getTerminal(addModal,true)">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/archive.svg"
         
        /><a>Edit</a>
      </td>
      <td class="icons" (click)="deleteTerminal()">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/rubbish-can.svg"
        /><a>Delete</a>
      </td>
      <td class="icons" (click)="toogleStatus()">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/open.svg"
        /><a>Enable</a>
      </td>
      <td class="icons" (click)="toogleStatus()">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/closed.svg"
        /><a>Disable</a>
      </td>
      <td class="icons">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/archive (1).svg"
        /><a>Copy</a>
      </td>
      <td class="icons">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/files.svg"
        /><a>Batch Deploy</a>
      </td>

      <td class="icons">
        <img class="flexicon-image" src="../../../assets/img/arrows.svg" /><a
          >Import</a
        >
      </td>
      <td class="icons">
        <img
          class="flexicon-image"
          src="../../../assets/img/arrows (1).svg"
        /><a>Export</a>
      </td>
      <td class="icons">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/interface (1).svg"
        /><a>Schedule</a>
      </td>
      <td class="icons">
        <img
          class="flexicon-image img-responsive"
          src="../../../assets/img/computer.svg"
        /><a>Restore</a>
      </td>
    </tr>
  </table>
  <br />

  <!-- table -->
  <div class="table-responsive">
    <table class="table table-striped table-hover mb-0">
      <!--Table head-->
      <thead>
        <tr style="text-align: center">
          <th>
            <div class="custom-control custom-checkbox center">
              <input
                type="checkbox"
                class="checkbox-style"
                id="tableDefaultCheck2"
                (change)="checkAll()"
                [(ngModel)]="masterSelected"
              />
            </div>
          </th>
          <th class="th-md">S/N</th>

          <th class="th-md">
            <a (click)="sortBy('terminal_id')"
              >Terminal ID
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>

          <th class="th-md">
            <a (click)="sortBy('merchant_id')"
              >Model
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>

          <th class="th-md">
            <a (click)="sortBy('printer_status')"
              >Status
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>
          <th class="th-md">
            <a (click)="sortBy('printer_status')"
              >Download SN
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>
          <th class="th-md">
            <a (click)="sortBy('printer_status')"
              >Last Download Time
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>
          <th class="th-md">
            <a (click)="sortBy('printer_status')">
              Download Status
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>
          <th class="th-md">
            <a (click)="sortBy('printer_status')"
              >Update Time
              <i class="fa fa-sort ml-1"></i>
            </a>
          </th>
        </tr>
      </thead>
      <!--Table head-->

      <!--Table body-->
      <tbody>
        <tr
          *ngFor="let row of terminals; let i = index"
          style="text-align: center"
        >
          <td>
            <div class="custom-control custom-checkbox center">
              <input type="checkbox" class="checkbox-style" [(ngModel)]="row.isSelected" (change)="getUnassigned(row.isSelected,row.id)" />
              <!-- <label class="custom-control-label" for="tableDefaultCheck2">Check 2</label> -->
            </div>
            <!-- <input type="checkbox" [(ngModel)]="row.isSelected" (change)="getUnassigned(row.isSelected, row.serialNumber)">  -->
          </td>

          <td>{{ serial + i }}</td>
          <td>{{ row.terminalID }}</td>
          <td>{{ row.modelId }}</td>
          <td>{{ row.status }}</td>
          <td>{{ row.firmwareId }}</td>
          <td>{{ row.limitDownloadTime }}</td>
          <td>{{ row.isDeleteAllApplications }}</td>
          <td>{{ row.updatedAt }}</td>
        </tr>
      </tbody>
      <!-- {
            "id": 9,
            "applicationId": 2,
            "terminalID": "4t6673456",
            "modelId": 3,
            "firmwareId": 1,
            "caption": "another one",
            "description": "well lets see again",
            "limitDownloadTime": 0,
            "limitDownloadInterval": 0,
            "notDownloadEDCParameters": false,
            "notDownloadENVParameters": false,
            "removable": true,
            "archived": false,
            "startDate": "2020-05-10T19:08:17.124Z",
            "status": "active",
            "expirationDate": "2020-05-20T19:08:17.125Z",
            "isDeleteAllApplications": false,
            "createdAt": "2020-05-10T19:08:17.211Z",
            "updatedAt": "2020-05-12T13:45:23.201Z",
            "application": {
                "id": 2,
                "name": "the app 1.0.1",
                "modelId": 2,
                "createdAt": "2020-05-10T09:11:25.166Z",
                "updatedAt": "2020-05-10T09:11:25.166Z"
            },
            "firmware": {
                "id": 1,
                "name": "firmware 1.0.2",
                "modelId": 2,
                "createdAt": "2020-05-10T10:20:19.418Z",
                "updatedAt": "2020-05-10T10:20:19.418Z"
            }
        },
        {
            "id": 2,
            "applicationId": 1,
            "terminalID": "yyu6737845",
            "modelId": 2,
            "firmwareId": 2,
            "caption": "Getting updated",
            "description": "Just some more text",
            "limitDownloadTime": 0,
            "limitDownloadInterval": 0,
            "notDownloadEDCParameters": false,
            "notDownloadENVParameters": false,
            "removable": false,
            "archived": false,
            "startDate": "2020-05-13T13:42:28.545Z",
            "status": "active",
            "expirationDate": "2020-05-22T13:42:28.545Z",
            "isDeleteAllApplications": false,
            "createdAt": "2020-05-10T14:43:26.971Z",
            "updatedAt": "2020-05-12T13:43:08.667Z",
            "application": {
                "id": 1,
                "name": "TMS app 1.0.1",
                "modelId": 2,
                "createdAt": "2020-05-10T09:11:02.482Z",
                "updatedAt": "2020-05-10T09:11:02.482Z"
            },
            "firmware": {
                "id": 2,
                "name": "firmware 1.0.4",
                "modelId": 2,
                "createdAt": "2020-05-10T10:20:34.042Z",
                "updatedAt": "2020-05-10T10:20:34.042Z" -->

      <!--Table body-->
      <tbody *ngIf="isData == false; else gettingData">
        <tr>
          <td colspan="15" style="text-align: center; padding: 5% 20%">
            <strong>No Data Available</strong>
          </td>
        </tr>
      </tbody>
      <ng-template #gettingData>
        <tbody *ngIf="isData == undefined">
          <tr>
            <td colspan="15" style="text-align: center; padding: 5% 20%">
              <mdb-spinner spinnerColor="blue"></mdb-spinner>
            </td>
          </tr>
        </tbody>
      </ng-template>
    </table>
  </div>
</div>

<!-- view terminal modal -->
<div
  mdbModal
  #viewModal="mdbModal"
  class="modal fade"
  style="overflow: auto"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myBasicModalLabel"
  aria-hidden="true"
  [config]="{ backdrop: true, ignoreBackdropClick: false }"
>
  <div class="modal-dialog modal-dialog-scrollable wider modal-fluid" role="document" *ngIf="terminal">
    <div class="modal-content" *ngIf="terminal">
      <div class="modal-header">
        <div class="header">
          <p>View Terminal</p>
        </div>
        <div>
          <button type="button" class="btn btn-uc btn-sm waves-light" aria-label="Close"
          data-dismiss="modal" style="    color: red !important;
      background-color: white !important;
      
      font-size: 13px;
      font-weight: bold;
      display: flex;
      text-align: center;
      border: 1px solid !important;
      " (click)="viewModal.hide()" mdbWavesEffect><i class="fas fa-times"
              style="text-align: center; align-self: center; "></i>
      </button>

        </div>
      </div>

     
        <!-- modal head -->
        

        <br />
        <!-- modal body -->
        <div class="modal-body">
          <div class="table-responsive">

         
          <div class="row">
              <!--first column--> 
            <div class="col-lg-6">

            
            <div class="py-1">
              <div class="row input-style">
                  <p class="col-lg-6 no-change m-0 title col-4">Terminal ID</p>
                  <p class="col-lg-6 no-change m-0 subtitle col-8">
                      {{terminal.terminalID}}</p>
              </div>
          </div>
          <br>
          <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Model ID</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.modelId}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Caption </p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.caption || 'null'}}</p>
            </div>
        </div> 
        <br> 
           <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Application Name</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.application.name}}</p>
            </div>
        </div> 
        <br>
        <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Application Model ID</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.application.modelId}}</p>
            </div>
        </div>
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Created At</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.createdAt}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Limit Download Time</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.limitDownloadTime}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">notDownload EDCParameters</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.notDownloadEDCParameters}}</p>
            </div>
        </div>
        <br>
        <!-- <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">notDownload EDCParameters</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.notDownloadEDCParameters}}</p>
            </div>
        </div> -->
        <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Removable</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.removable}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Start Date</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.startDate || 'null'}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Status</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.status}}</p>
            </div>
        </div>
        <br>
      </div>  
     
      <!--second column--> 
       <div class="col-lg-6">

            
            <div class="py-1">
              <div class="row input-style">
                  <p class="col-lg-6 no-change m-0 title col-4">Application ID</p>
                  <p class="col-lg-6 no-change m-0 subtitle col-8">
                      {{terminal.applicationId}}</p>
              </div>
          </div>
          <br>
          <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Firmware ID</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.firmwareId}}</p>
            </div>
        </div>  
        <br>
           <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Description</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.description || 'null'}}</p>
            </div>
        </div> 
        <br>
        <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Firmware Name</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.firmware.name}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Firmware Model ID</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.firmware.modelId}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Updated At</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.updatedAt}}</p>
            </div>
        </div> 
        <br>
        <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Limit Download Interval</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.limitDownloadInterval}}</p>
            </div>
        </div>
        <br>
        <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">notDownload ENVParameters</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.notDownloadENVParameters}}</p>
            </div>
        </div>
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Archived</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.archived}}</p>
            </div>
        </div> 
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Expiration Date</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.expirationDate || 'null'}}</p>
            </div>
        </div>
        <br>
         <div class="py-1">
            <div class="row input-style">
                <p class="col-lg-6 no-change m-0 title col-4">Delete All Application</p>
                <p class="col-lg-6 no-change m-0 subtitle col-8">
                    {{terminal.isDeleteAllApplications}}</p>
            </div>
        </div>
        <br>
      </div>
   
          </div>
        </div>   
        </div>
        <hr />
        <!-- modal footer -->
        <div class="modal-footer">
       
        <div class="buttons">
         
          <button type="button" class="btn done-btn" (click)="viewModal.hide()">Done</button>
        </div>
      </div>
      
    </div>
  </div>
</div>

<!-- add & edit terminal modal -->
<div
  mdbModal
  #addModal="mdbModal"
  class="modal fade"
  style="overflow: auto"
  tabindex="-1"
  role="dialog"
  aria-labelledby="myBasicModalLabel"
  aria-hidden="true"
  [config]="{ backdrop: true, ignoreBackdropClick: false }"
>
  <div class="modal-dialog modal-dialog-scrollable modal-fluid" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <div class="header">
          <p *ngIf="!edit">Add Terminal</p>
          <p *ngIf="edit">Edit Terminal</p>
        </div>
        <div>
          <button type="button" class="btn btn-uc btn-sm waves-light" aria-label="Close"
          data-dismiss="modal" style="    color: red !important;
      background-color: white !important;
      
      font-size: 13px;
      font-weight: bold;
      display: flex;
      text-align: center;
      border: 1px solid !important;
      " (click)="addModal.hide()" mdbWavesEffect><i class="fas fa-times"
              style="text-align: center; align-self: center; "></i>
      </button>

        </div>
      </div>
 <!-- modal body -->
      <div class="modal-body"> 
        <div class="table-responsive">
          <div class="row">
            <div class="col-lg-6">
              <br>
              <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Terminal ID</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="terminalId" name="terminalId"
                    type="text" />

                </div>
            </div>  
            <br>
             <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Application ID</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="applicationId" name="applicationId"
                    type="text" />

                </div>
            </div>  
            <br>    
                 <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">CAPK ID</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="capkId" name="capkId"
                    type="text" />

                </div>
            </div> 
            <br>
            <div class="py-1">
              <div class="row input-style">
                  <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Start Date</p>
                  <input class="col-lg-8 form-control my-0 py-0"
                  [ngModelOptions]="{standalone: true}" ngDefaultControl
                  [(ngModel)]="startDate" name="startDate" value="startDate"
                  type="date" />

              </div>
          </div>
          <br>
            <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Description</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="description" name="description"
                    type="text" />

                </div>
            </div>   
            <br>
            </div>
            <div class="col-lg-6">
              <br>
              <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Model ID</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="modelId" name="modelId"
                    type="text" />

                </div>
            </div>  
            <br> 
             <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Firmware ID</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="firmwareId" name="firmwareId"
                    type="text" />

                </div>
            </div> 
            <br>
             <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Caption</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="caption" name="caption"
                    type="text" />

                </div>
            </div>  
            <br>
             <div class="py-1">
                <div class="row input-style">
                    <p class="col-lg-6 no-change m-0 title col-4 p-input-style">Expiration Date</p>
                    <input class="col-lg-8 form-control my-0 py-0"
                    [ngModelOptions]="{standalone: true}" ngDefaultControl
                    [(ngModel)]="expDate" name="expDate" 
                    (ngModelChange)="expDate=$event"
                    type="date" />

                </div>
            </div>
            <br>
            </div>
          </div>
         
        </div>
        <hr />
        <!-- modal footer -->
        <div class="buttons">
          <button type="button" class="btn back-btn" (click)="addModal.hide()">Close</button>
          <button type="button" class="btn done-btn" (click)="addTerminal()" *ngIf="!edit">Proceed</button> 
          <button type="button" class="btn done-btn" (click)="editTerminal()" *ngIf="edit">Edit</button>
        </div>
      </div>
    </div>
  </div>
</div>


